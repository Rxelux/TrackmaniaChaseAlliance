//#RequireContext CSmMode

#Include "ChaseAlliance/Libs/Common/Log.Script.txt"
#Include "ChaseAlliance/Libs/ChaseAlliance/Players.Script.txt" as PlayersL
#Include "ChaseAlliance/Libs/ChaseAlliance/Ranked.Script.txt" as Ranked

// declare Text SecretAPIUrl;

// Void Init(Text _SecretAPIUrl) {
// 	SecretAPIUrl = _SecretAPIUrl;
// }

Void PostPlayerCount(Text _HttpApiURL, Integer _PlayerCount) {
	// Init(SecretAPIUrl);
    declare CHttpRequest Req = Http.CreatePost(_HttpApiURL^"/player_count/"^_PlayerCount, "");
    // wait(Req.IsCompleted);
    // Log(Req.Result);
    Http.Destroy(Req);
}

Text GetRankedPlayersStats(Text[] _PlayersLoginTeam1, Text[] _PlayersLoginTeam2) {
	// TODO: Get ranked players stats
	// declare CHttpRequest Req = Http.CreatePost(_HttpApiURL^"/ranked_results", _RankedResults);
	// // wait(Req.IsCompleted);
	// // Log(Req.Result);
	// Http.Destroy(Req);
	return "";
}

Void PostRankedResults(Text _HttpApiURL, Ranked::K_ChaseTeamsPlayers _ChaseRankedTeamWinning, Ranked::K_ChaseTeamsPlayers _ChaseRankedTeamLoosing) {
	// Init(SecretAPIUrl);
	// TODO: Post ranked results
	// declare CHttpRequest Req = Http.CreatePost(_HttpApiURL^"/ranked_results", _RankedResults);
	// // wait(Req.IsCompleted);
	// // Log(Req.Result);
	// Http.Destroy(Req);
}

Text GetRankedPointsChange(Text _HttpApiURL, Ranked::K_ChaseTeamsPlayers _ChaseRankedTeamWinning, Ranked::K_ChaseTeamsPlayers _ChaseRankedTeamLoosing) {
	// TODO: Get ranked points change
	// declare CHttpRequest Req = Http.CreatePost(_HttpApiURL^"/ranked_results", _RankedResults);
	// // wait(Req.IsCompleted);
	// // Log(Req.Result);
	// Http.Destroy(Req);
	return "";
}

Void PassModeEvent(CSmModeEvent _Event, Text _HttpApiURL){
	// Init(SecretAPIUrl);
	if (_Event.Type == CSmModeEvent::EType::OnPlayerAdded || _Event.Type == CSmModeEvent::EType::OnPlayerRemoved){
		// log("ModeEvent : PlayerCount: "^PlayersL::GetCurrentPlayerCount());
		if (_HttpApiURL != ""){
			PostPlayerCount(_HttpApiURL, PlayersL::GetCurrentPlayerCount());
		}
	}
}

declare Boolean G_Loaded;
Void Unload() {
	G_Loaded = False;
}

Void Load() {
	if(G_Loaded)return;
	Unload();
	G_Loaded = True;
}





